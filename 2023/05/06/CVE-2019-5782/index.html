<!DOCTYPE html>
<html lang="en">
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    <meta name="description" content="In this post, I will analyze and exploit CVE-2019-5782, a bug caused by the improper implementation of Turbofan, a JIT compiler in V8. We can exploit the mishandling of arguments.length by Turbofan to">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;&#x3D; V8 &lt; 7.3.1)">
<meta property="og:url" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/index.html">
<meta property="og:site_name" content="Aaron&#39;s Note">
<meta property="og:description" content="In this post, I will analyze and exploit CVE-2019-5782, a bug caused by the improper implementation of Turbofan, a JIT compiler in V8. We can exploit the mishandling of arguments.length by Turbofan to">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://aaronsjcho.github.io/image-20251101161422495.png">
<meta property="og:image" content="https://aaronsjcho.github.io/image-20251101162750464.png">
<meta property="og:image" content="https://aaronsjcho.github.io/image-20251101162803492.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/7.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/8.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/9.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/10.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/11.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/12.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/13.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/14.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/15.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/16.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/17.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/18.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/19.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/20.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/21.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/22.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/23.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/24.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/25.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/26.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/27.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/28.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/29.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/30.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/31.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/32.png">
<meta property="og:image" content="https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/pwn.png">
<meta property="article:published_time" content="2023-05-06T03:00:00.000Z">
<meta property="article:modified_time" content="2025-11-01T07:51:10.469Z">
<meta property="article:author" content="Seongjoon Cho">
<meta property="article:tag" content="chromium">
<meta property="article:tag" content="v8">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://aaronsjcho.github.io/image-20251101161422495.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TXRLJ2S4LP"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-TXRLJ2S4LP');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/07/29/Escaping-V8-Sandbox-via-JIT-Spraying-by-Turbofan-Part-1/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/04/30/Escaping-V8-Sandbox-via-Backing-Store-of-ArrayBuffer-and-WebAssembly-Code-Space-Part-2/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.facebook.com/sharer.php?u=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/share?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&text=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.linkedin.com/shareArticle?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://pinterest.com/pin/create/bookmarklet/?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&is_video=false&description=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)&body=Check out this article: https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://getpocket.com/save?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://reddit.com/submit?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.stumbleupon.com/submit?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://digg.com/submit?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.tumblr.com/share/link?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&name=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://news.ycombinator.com/submitlink?u=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&t=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup"><span class="toc-number">1.</span> <span class="toc-text">Setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis"><span class="toc-number">2.</span> <span class="toc-text">Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Typing-arguments-length"><span class="toc-number">2.1.</span> <span class="toc-text">Typing arguments.length</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Root-cause"><span class="toc-number">2.2.</span> <span class="toc-text">Root cause</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">3.</span> <span class="toc-text">Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Trigger-OOB-using-the-right-shift-operator"><span class="toc-number">3.1.</span> <span class="toc-text">Trigger OOB using the right shift operator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Obtain-OOB-array"><span class="toc-number">3.2.</span> <span class="toc-text">Obtain OOB array</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-the-address-of-an-arbitrary-object"><span class="toc-number">3.3.</span> <span class="toc-text">Get the address of an arbitrary object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arbitrary-address-read-write"><span class="toc-number">3.4.</span> <span class="toc-text">Arbitrary address read&#x2F;write</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arbitrary-code-execution"><span class="toc-number">3.5.</span> <span class="toc-text">Arbitrary code execution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bisection"><span class="toc-number">4.</span> <span class="toc-text">Bisection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Patch"><span class="toc-number">5.</span> <span class="toc-text">Patch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">6.</span> <span class="toc-text">References</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Seongjoon Cho</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-05-06T03:00:00.000Z" class="dt-published" itemprop="datePublished">2023-05-06</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/N-day/">N-day</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/chromium/" rel="tag">chromium</a>, <a class="p-category" href="/tags/v8/" rel="tag">v8</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>In this post, I will analyze and exploit CVE-2019-5782, a bug caused by the improper implementation of Turbofan, a JIT compiler in V8. We can exploit the mishandling of <code>arguments.length</code> by Turbofan to trigger out-of-bounds access and achieve arbitrary code execution.</p>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><ul>
<li>Ubuntu 20.04 (WSL)</li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/commit/18b28402118b7918512c3e5b6bc5c6f348d43564"><code>18b28402118b7918512c3e5b6bc5c6f348d43564</code></a> (Nov 30, 2018)</li>
</ul>
<p>Run <a href="setup.zsh"><code>setup.zsh</code></a> in the working directory.</p>
<h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><h3 id="Typing-arguments-length"><a href="#Typing-arguments-length" class="headerlink" title="Typing arguments.length"></a>Typing arguments.length</h3><p><code>arguments.length</code> implies the length of <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Functions/arguments"><code>arguments</code></a> array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> <span class="variable language_">arguments</span>.<span class="property">length</span>; &#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">f</span>()); <span class="comment">// 0</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">f</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p><img src="/image-20251101161422495.png" alt="image-20251101161422495"></p>
<p>The maximum number of arguments of a JavaScript function is defined by <code>Code::kMaxArguments</code> as <code>0xfffe</code>.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* src/objects/code.h:433-435 */</span></span><br><span class="line"></span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> kArgumentsBits = <span class="number">16</span>;</span><br><span class="line">  <span class="comment">// Reserve one argument count value as the &quot;don&#x27;t adapt arguments&quot; sentinel.</span></span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> kMaxArguments = (<span class="number">1</span> &lt;&lt; kArgumentsBits) - <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>Thus, the type of <code>arguments.length</code> is predefined for Turbofan compilation by <code>TypeCache::kArgumentsLengthType</code>.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* src/compiler/type-cache.h:168-170 */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// The valid number of arguments for JavaScript functions.</span></span><br><span class="line">  Type <span class="type">const</span> kArgumentsLengthType =</span><br><span class="line">      Type::<span class="built_in">Range</span>(<span class="number">0.0</span>, Code::kMaxArguments, <span class="built_in">zone</span>());</span><br></pre></td></tr></table></figure>

<p>When Turbofan encounters <code>arguments.length</code> while compiling a JavaScript function, it sets the type of the node to <code>TypeCache::kArgumentsLengthType</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% <span class="title class_">OptimizeFunctionOnNextCall</span>(f);</span><br><span class="line"><span class="title function_">f</span>();</span><br></pre></td></tr></table></figure>

<p><img src="/image-20251101162750464.png" alt="image-20251101162750464"></p>
<p><img src="/image-20251101162803492.png" alt="image-20251101162803492"></p>
<h3 id="Root-cause"><a href="#Root-cause" class="headerlink" title="Root cause"></a>Root cause</h3><p>However, we can actually pass more than <code>0xfffe</code> arguments to a JavaScript function. If so, <code>arguments.length</code> is mistyped, eventually leading to type confusion.</p>
<h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><h3 id="Trigger-OOB-using-the-right-shift-operator"><a href="#Trigger-OOB-using-the-right-shift-operator" class="headerlink" title="Trigger OOB using the right shift operator"></a>Trigger OOB using the right shift operator</h3><p><a href="oob.js"><code>oob.js</code></a></p>
<p>The right shift (<code>&gt;&gt;</code>) operator is interpreted as the <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/interpreter/interpreter-generator.cc#L1051"><code>ShiftRight</code></a> (or <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/interpreter/interpreter-generator.cc#L1138"><code>ShiftRightSmi</code></a> in case the right operand is an integer) bytecode instruction.</p>
<p><img src="/2023/05/06/CVE-2019-5782/7.png"></p>
<p>In the <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/pipeline.cc#L1013"><code>GraphBuilderPhase</code></a> of Turbofan compilation, a <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/js-type-hint-lowering.cc#L132"><code>SpeculativeNumberShiftRight</code></a> node is built from the <code>ShiftRight</code> instruction.</p>
<p><img src="/2023/05/06/CVE-2019-5782/8.png"></p>
<p>In <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/pipeline.cc#L1119"><code>TyperPhase</code></a>, <code>SpeculativeNumberShiftRight</code> is typed for the first time. <code>Arguments.length</code> is not optimised yet at this point, so the <code>LoadField</code> node responsible for reading the <code>length</code> field of <code>arguments</code> is passed as the left operand.</p>
<p><img src="/2023/05/06/CVE-2019-5782/9.png"></p>
<p>The type is calculated by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/operation-typer.cc#L959"><code>OperationTyper::NumberShiftRight()</code></a>, called by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/operation-typer.cc#L1110"><code>OperationTyper::SpeculativeNumberShiftRight()</code></a>. The logic is intuitive. It sets <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/operation-typer.cc#L977"><code>min</code></a> to the smaller value between <code>min_lhs &gt;&gt; min_rhs</code> and <code>min_lhs &gt;&gt; max_rhs</code>, and sets <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/operation-typer.cc#L978"><code>max</code></a> to the larger value between <code>max_lhs &gt;&gt; min_rhs</code> and <code>max_lhs &gt;&gt; max_rhs</code>.</p>
<p><img src="/2023/05/06/CVE-2019-5782/10.png"></p>
<p>As a result, the initial type of <code>SpeculativeNumberShiftRight</code> is set to <code>Range(-32768, 32767)</code>.</p>
<p><img src="/2023/05/06/CVE-2019-5782/11.png"></p>
<p>In <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/pipeline.cc#L1192"><code>TypedLoweringPhase</code></a>, <code>JSCreateArguments</code> is reduced by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/js-create-lowering.cc#L169"><code>JSCreateLowering::ReduceJSCreateArguments()</code></a>. The nodes responsible for storing <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/js-create-lowering.cc#L210"><code>arguments_map</code></a>, <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/js-create-lowering.cc#L211"><code>properties</code></a>, <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/js-create-lowering.cc#L212"><code>elements</code></a>, <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/js-create-lowering.cc#L213"><code>arguments_length</code></a>, and <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/js-create-lowering.cc#L214"><code>callee</code></a> are created, and <code>JSCreateArguments</code> is converted to a <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/allocation-builder.h#L72"><code>FinishRegion</code></a> node by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/js-create-lowering.cc#L216"><code>AllocationBuilder::FinishAndChange()</code></a>.</p>
<p><img src="/2023/05/06/CVE-2019-5782/12.png"></p>
<p><img src="/2023/05/06/CVE-2019-5782/13.png"></p>
<p>In <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/pipeline.cc#L1400"><code>LoadEliminationPhase</code></a>, the <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/load-elimination.cc#L114"><code>LoadField</code></a> node is reduced by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/load-elimination.cc#L115"><code>LoadElimination::ReduceLoadField()</code></a>. The output of <code>LoadField</code>, which is the length of the <code>arguments</code> object, already exists in the graph as an <code>ArgumentsLength</code> node. <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/load-elimination.cc#L787"><code>LoadElimination::ReduceLoadField()</code></a> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/load-elimination.cc#L807">looks</a> for the <code>ArgumentsLength</code> from the graph, and <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/load-elimination.cc#L822">replaces</a> the current <code>LoadField</code> with the <code>ArgumentsLength</code>.</p>
<p><img src="/2023/05/06/CVE-2019-5782/14.png"></p>
<p><img src="/2023/05/06/CVE-2019-5782/15.png"></p>
<p>In <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/pipeline.cc#L1245"><code>SimplifiedLoweringPhase</code></a>, <code>SpeculativeNumberShiftRight</code> is typed again by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/simplified-lowering.cc#L453"><code>OperationTyper::NumberShiftRight()</code></a>, called by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/simplified-lowering.cc#L416"><code>RepresentationSelector::UpdateFeedbackType()</code></a>. The logic is the same as in <code>TyperPhase</code>,  but the type of left input node is <code>TypeCache::kArgumentsLengthType</code> at this time, resulting in both <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/operation-typer.cc#L977"><code>min</code></a> and <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/operation-typer.cc#L978"><code>max</code></a> being 0.</p>
<p><img src="/2023/05/06/CVE-2019-5782/16.png"></p>
<p>The result of <code>SpeculativeNumberShiftRight</code> is used as <code>idx</code> to get an element from <code>arr</code>. The <code>CheckBounds</code> node is responsible for preventing out-of-bounds. It takes the index as the first input and the length of the array as the second, and checks if the index is less than the length.</p>
<p><img src="/2023/05/06/CVE-2019-5782/17.png"></p>
<p>Also in <code>SimplifiedLoweringPhase</code>, <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/simplified-lowering.cc#L2611"><code>CheckBounds</code></a> is reduced by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/simplified-lowering.cc#L1523"><code>RepresentationSelector::VisitCheckBounds()</code></a>. In case <code>index_type.Max()</code> is smaller than <code>length_type.Min()</code>, there’s no possibility of out-of-bounds, so <code>VisitCheckBounds()</code> calls <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/compiler/simplified-lowering.cc#L1542"><code>RepresentationSelector::DeferReplacement()</code></a> to remove <code>CheckBounds</code>.</p>
<p><img src="/2023/05/06/CVE-2019-5782/18.png"></p>
<p><img src="/2023/05/06/CVE-2019-5782/19.png"></p>
<p>After compilation is finished, <code>f()</code> takes <code>0x10000</code> arguments, but Turbofan didn’t consider it possible. The bounds check was already removed because Turbofan assumed that <code>idx</code> is always 0. However, <code>idx</code> becomes 1 this time, so we can access the out-of-bounds of <code>arr</code> and read the value at the location corresponding to <code>arr[1]</code>.</p>
<p><img src="/2023/05/06/CVE-2019-5782/20.png"></p>
<h3 id="Obtain-OOB-array"><a href="#Obtain-OOB-array" class="headerlink" title="Obtain OOB array"></a>Obtain OOB array</h3><p>We can access the length field of an array using OOB.</p>
<p><img src="/2023/05/06/CVE-2019-5782/21.png"></p>
<p><img src="/2023/05/06/CVE-2019-5782/22.png"></p>
<p>Even if we overwrite the length field of the array with a larger value, the array of elements stays put.</p>
<p><img src="/2023/05/06/CVE-2019-5782/23.png"></p>
<p><img src="/2023/05/06/CVE-2019-5782/24.png"></p>
<p>Via this OOB array, we can access elements beyond the bounds of the array, like <code>arr[100]</code>, which should be <code>undefined</code> under normal circumstances.</p>
<p><img src="/2023/05/06/CVE-2019-5782/25.png"></p>
<h3 id="Get-the-address-of-an-arbitrary-object"><a href="#Get-the-address-of-an-arbitrary-object" class="headerlink" title="Get the address of an arbitrary object"></a>Get the address of an arbitrary object</h3><p>An array containing JavaScript objects contains their addresses in its memory.</p>
<p><img src="/2023/05/06/CVE-2019-5782/26.png"></p>
<p><img src="/2023/05/06/CVE-2019-5782/27.png"></p>
<p><img src="/2023/05/06/CVE-2019-5782/28.png"></p>
<p>We can place an array of objects right behind the OOB array we obtained above, and read the value stored in the array of objects via the OOB array. Then, we can get the address of an arbitrary object in the form of a floating-point number.</p>
<h3 id="Arbitrary-address-read-write"><a href="#Arbitrary-address-read-write" class="headerlink" title="Arbitrary address read&#x2F;write"></a>Arbitrary address read&#x2F;write</h3><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/objects/js-array-buffer.h#L185"><code>JSTypedArray</code></a> has a <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/objects/fixed-array.h#L575"><code>FixedTypedArrayBase</code></a> object in its elements field. <code>FixedTypedArrayBase</code> has a <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/objects/fixed-array.h#L578"><code>base_pointer</code></a> that points to the object itself, and an <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/blob/18b28402118b7918512c3e5b6bc5c6f348d43564/src/objects/fixed-array.h#L583"><code>external_pointer</code></a>, which indicates the distance between the <code>base_pointer</code> and the actual data.</p>
<p><img src="/2023/05/06/CVE-2019-5782/29.png"></p>
<p><img src="/2023/05/06/CVE-2019-5782/30.png"></p>
<p>We can place a <code>JSTypedArray</code> right behind the OOB array we obtained above, and overwrite <code>base_pointer</code> and <code>external_pointer</code> with an arbitrary address and 0, respectively. Then, we can read the value at the address through that array, and any value we store in that array would be written to that address.</p>
<p><a href="rw.js"><code>rw.js</code></a></p>
<p><img src="/2023/05/06/CVE-2019-5782/31.png"></p>
<p><img src="/2023/05/06/CVE-2019-5782/32.png"></p>
<h3 id="Arbitrary-code-execution"><a href="#Arbitrary-code-execution" class="headerlink" title="Arbitrary code execution"></a>Arbitrary code execution</h3><blockquote>
<a href="/2023/04/29/v8sbx-ab-1/" title="Escaping V8 Sandbox via Backing Store of ArrayBuffer and WebAssembly Code Space: Part 1 (V8 &lt; 10.0.138)"><p>Escaping V8 Sandbox via Backing Store of ArrayBuffer and WebAssembly Code Space: Part 1 (V8 < 10.0.138)</p></a></blockquote>
<p><a href="pwn.wat"><code>pwn.wat</code></a> <a href="shellcode.py"><code>shellcode.py</code></a> <a href="pwn.js"><code>pwn.js</code></a></p>
<p><img src="/2023/05/06/CVE-2019-5782/pwn.png"></p>
<h2 id="Bisection"><a href="#Bisection" class="headerlink" title="Bisection"></a>Bisection</h2><blockquote>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/commit/bac7dad666ae203e04b5ff68d838ed2ea5f03e26">[Build] Disable build-time untrusted code mitigations on non-Android platforms and ia32.</a> (Oct 18, 2018)</p>
<p>Non-Android platforms are protected in Chrome by site isolation, therefore we can disable the untrusted code mitigations. We still enable them on Android, and on simulator builds since that is where we do much of the correctness testing for Android.</p>
</blockquote>
<h2 id="Patch"><a href="#Patch" class="headerlink" title="Patch"></a>Patch</h2><blockquote>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/commit/4e3a17d0408627517d4a81b3bf5daf85e416e9ac">[runtime] Reduce spread&#x2F;apply call max arguments</a> (Nov 22, 2018)</p>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/commit/ff0cf00c72c2b7e12f6e15a575604c8a26ab4364">Revert “[runtime] Reduce spread&#x2F;apply call max arguments”</a> (Nov 30, 2018)</p>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/v8/v8/commit/8e4588915ba7a9d9d744075781cea114d49f0c7b">[turbofan] Relax range for arguments object length</a> (Nov 30, 2018)</p>
</blockquote>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://chromereleases.googleblog.com/2019/01/stable-channel-update-for-desktop.html">Stable Channel Update for Desktop (Tuesday, January 29, 2019) - Chrome Releases</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://issues.chromium.org/issues/40093090">Security: Tianfu CUP RCE - Chromium Issues</a></li>
</ul>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/categories/">Category</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup"><span class="toc-number">1.</span> <span class="toc-text">Setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis"><span class="toc-number">2.</span> <span class="toc-text">Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Typing-arguments-length"><span class="toc-number">2.1.</span> <span class="toc-text">Typing arguments.length</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Root-cause"><span class="toc-number">2.2.</span> <span class="toc-text">Root cause</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">3.</span> <span class="toc-text">Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Trigger-OOB-using-the-right-shift-operator"><span class="toc-number">3.1.</span> <span class="toc-text">Trigger OOB using the right shift operator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Obtain-OOB-array"><span class="toc-number">3.2.</span> <span class="toc-text">Obtain OOB array</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-the-address-of-an-arbitrary-object"><span class="toc-number">3.3.</span> <span class="toc-text">Get the address of an arbitrary object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arbitrary-address-read-write"><span class="toc-number">3.4.</span> <span class="toc-text">Arbitrary address read&#x2F;write</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arbitrary-code-execution"><span class="toc-number">3.5.</span> <span class="toc-text">Arbitrary code execution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bisection"><span class="toc-number">4.</span> <span class="toc-text">Bisection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Patch"><span class="toc-number">5.</span> <span class="toc-text">Patch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">6.</span> <span class="toc-text">References</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.facebook.com/sharer.php?u=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/share?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&text=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.linkedin.com/shareArticle?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://pinterest.com/pin/create/bookmarklet/?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&is_video=false&description=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)&body=Check out this article: https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://getpocket.com/save?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://reddit.com/submit?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.stumbleupon.com/submit?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://digg.com/submit?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&title=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="http://www.tumblr.com/share/link?url=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&name=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="external nofollow noopener noreferrer" href="https://news.ycombinator.com/submitlink?u=https://aaronsjcho.github.io/2023/05/06/CVE-2019-5782/&t=CVE-2019-5782: Improper Typing for arguments.length by Turbofan Leading to RCE (7.2.41 &lt;= V8 &lt; 7.3.1)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2019-2025
    Seongjoon Cho
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'">


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'aaronsjcho/aaronsjcho.github.io';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'comment';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
