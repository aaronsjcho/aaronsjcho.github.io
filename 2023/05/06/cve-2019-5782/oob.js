// flags: --allow-natives-syntax --print-bytecode --trace-turbo

const kArgumentsBits = 16;
const kMaxArguments = (1 << kArgumentsBits) - 2; // 0xfffe

let arr;

function f() {
  let idx = arguments.length >> kArgumentsBits; // optimised to 0

  arr = [1.1]; // idx is always smaller than arr.length
  return arr[idx]; // CheckBounds is optimised out
}

f();
% OptimizeFunctionOnNextCall(f); // compile with turbofan
f();

let args = new Array(0x10000);
console.log(f(...args));
